<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.road_friends.rentalcar.mapper.UserAdminMapper">

    <!-- 전체 회원 수 조회 -->
    <select id="getUserCount" resultType="int">
        SELECT COUNT(*) FROM user
    </select>

    <!-- 활성 사용자 수 조회 (user_status = 0) -->
    <select id="getActiveUserCount" resultType="int">
        SELECT COUNT(*) FROM user WHERE user_status = 0
    </select>

    <!-- 탈퇴 사용자 수 조회 (user_status = 1) -->
    <select id="getInactiveUserCount" resultType="int">
        SELECT COUNT(*) FROM user WHERE user_status = 1
    </select>

    <!-- 남자 사용자 수 조회 (user_gender = 0) -->
    <select id="getMaleUserCount" resultType="int">
        SELECT COUNT(*) FROM user WHERE user_gender = 0
    </select>

    <!-- 여자 사용자 수 조회 (user_gender = 1) -->
    <select id="getFemaleUserCount" resultType="int">
        SELECT COUNT(*) FROM user WHERE user_gender = 1
    </select>

    <!-- 연령대별 사용자 수 조회 -->
    <select id="getAgeGroupCount" resultType="int">
        SELECT COUNT(*)
        FROM user
        WHERE YEAR(user_birth) BETWEEN #{startYear} AND #{endYear}
    </select>

    <!-- 모든 사용자 조회 (관리자용)-->
    <select id="getAllUsers" resultType="com.road_friends.rentalcar.dto.UserDTO">
        SELECT user_num, user_id, user_name, user_email, user_phone, user_address,
               user_status, user_gender, user_birth
        FROM user
        WHERE enabled = 1
    </select>

    <!-- 특정 사용자 상세 조회 (관리자용) -->
    <select id="getUserDetail"  resultType="com.road_friends.rentalcar.dto.UserDTO">
        SELECT user_num, user_id, user_name, user_email, user_phone, user_address,
               user_status, user_gender, user_birth
        FROM user
        WHERE user_num = #{userNum} AND enabled = 1
    </select>

    <!-- 특정 사용자 정보 수정 (관리자용) -->
    <update id="updateUser">
        UPDATE user
        SET user_name = #{userName},
            user_email = #{userEmail},
            user_phone = #{userPhone},
            user_address = #{userAddress},
            user_status = #{userStatus},
            user_birth = #{userBirth}
        WHERE user_num = #{userNum} AND enabled = 1
    </update>

</mapper>
