<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.road_friends.rentalcar.mapper.UserMapper">

    <!-- ‚úÖ Ï†ÑÏ≤¥ ÌöåÏõê Ïàò -->
    <select id="getTotalUsers" resultType="int">
        SELECT COUNT(*) FROM `user`
    </select>

    <!-- ‚úÖ ÏÑ±Î≥Ñ ÌÜµÍ≥Ñ -->
    <select id="getGenderStats" resultType="com.road_friends.rentalcar.dto.DataPoint">
        SELECT user_gender AS label, COUNT(*) AS count
        FROM `user`
        GROUP BY user_gender
    </select>

    <!-- üöÄ Ïó∞Î†πÎåÄÎ≥Ñ ÌöåÏõê Ïàò Ï°∞Ìöå -->
    <select id="getUserAgeGroups" resultType="map">
        SELECT
        CASE
        WHEN YEAR(CURDATE()) - YEAR(user_birth) BETWEEN 20 AND 29 THEN '20ÎåÄ'
        WHEN YEAR(CURDATE()) - YEAR(user_birth) BETWEEN 30 AND 39 THEN '30ÎåÄ'
        WHEN YEAR(CURDATE()) - YEAR(user_birth) BETWEEN 40 AND 49 THEN '40ÎåÄ'
        WHEN YEAR(CURDATE()) - YEAR(user_birth) BETWEEN 50 AND 59 THEN '50ÎåÄ'
        WHEN YEAR(CURDATE()) - YEAR(user_birth) >= 60 THEN '60ÎåÄ Ïù¥ÏÉÅ'
        ELSE 'Í∏∞ÌÉÄ'
        END AS label,
        COUNT(*) AS count
        FROM `user`
        GROUP BY label
    </select>

</mapper>
